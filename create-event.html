<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <title>Create Event</title> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Firebase SDK (placed in head for global availability) --> <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script> <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script> <script> // Firebase configuration â€“ must be loaded first const firebaseConfig = { apiKey: "AIzaSyCmFpsG231lCdIJtHeN6mH-Bxd-LHzrgZg", authDomain: "eventsearchprototype.firebaseapp.com", projectId: "eventsearchprototype", storageBucket: "eventsearchprototype.firebasestorage.app", messagingSenderId: "1090688920321", appId: "1:1090688920321:web:3b6c399e2686e1e2718900", measurementId: "G-KRG9R9WBF2" }; firebase.initializeApp(firebaseConfig); const db = firebase.firestore(); </script> <!-- CSS Styles --> <style> body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; } header { background: #fff; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); } nav a { margin: 0 10px; text-decoration: none; color: #333; } .container { width: 90%; max-width: 600px; margin: 20px auto; background: #fff; padding: 20px; border-radius: 5px; } form { display: flex; flex-direction: column; } label { font-weight: bold; margin-top: 10px; } input, textarea, select { padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px; } /* Image Preview */ #imagePreview { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 10px; } #imagePreview img { height: 100px; border-radius: 5px; object-fit: cover; } /* Map container */ #map { width: 100%; height: 300px; margin-top: 10px; border: 1px solid #ccc; border-radius: 5px; margin-bottom: 20px; } button[type="submit"] { padding: 10px; background: #333; color: #fff; border: none; border-radius: 5px; cursor: pointer; } @media (max-width: 600px) { input, textarea, select { font-size: 0.9em; padding: 8px; } button[type="submit"] { font-size: 0.9em; padding: 8px; } } </style> <!-- Script for Image Preview --> <script> // Preview selected images in reverse order (last selected appears first) function previewImages() { const previewContainer = document.getElementById("imagePreview"); previewContainer.innerHTML = ""; const files = document.getElementById("eventImages").files; const fileArray = Array.from(files).reverse(); fileArray.forEach(file => { const reader = new FileReader(); reader.onload = function(e) { const img = document.createElement("img"); img.src = e.target.result; previewContainer.appendChild(img); }; reader.readAsDataURL(file); }); } document.addEventListener("DOMContentLoaded", () => { document.getElementById("eventImages").addEventListener("change", previewImages); }); </script> <!-- Google Maps API: async defer with callback --> <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCuHVId8jAJzgLLfH0jUe9P0HoolsvF9V0&callback=initMap"></script> <!-- Map and Geocoding Script --> <script> let map, marker; // Global initMap function for API callback window.initMap = function() { const mapDiv = document.getElementById("map"); if (!mapDiv) { console.error("Error: Map container not found!"); return; } map = new google.maps.Map(mapDiv, { center: { lat: 31.5204, lng: 74.3587 }, // Default center (Lahore) zoom: 12 }); map.addListener("click", function(e) { placeMarker(e.latLng); }); }; // Place or update marker and update hidden latitude/longitude fields function placeMarker(location) { if (marker) { marker.setPosition(location); } else { marker = new google.maps.Marker({ position: location, map: map }); } document.getElementById("lat").value = location.lat(); document.getElementById("lng").value = location.lng(); } // Geocode manual address input when the field loses focus function geocodeAddress() { const address = document.getElementById("manualLocation").value; if (!address) return; if (typeof google === "undefined" || !google.maps || !google.maps.Geocoder) { console.error("Google Maps API not loaded yet."); return; } const geocoder = new google.maps.Geocoder(); geocoder.geocode({ address: address }, function(results, status) { if (status === "OK") { const loc = results[0].geometry.location; map.setCenter(loc); placeMarker(loc); } else { alert("Geocode was not successful: " + status); } }); } // Prevent form submission on Enter key in manual location field document.addEventListener("DOMContentLoaded", () => { const manualInput = document.getElementById("manualLocation"); manualInput.addEventListener("keydown", function(e) { if (e.key === "Enter") { e.preventDefault(); geocodeAddress(); } }); }); </script> <!-- Script for Province/City Dropdowns and Form Submission --> <script> // Mapping for provinces and major cities const provinceToCities = { "Punjab": ["Lahore", "Faisalabad", "Rawalpindi", "Gujranwala", "Sialkot"], "Sindh": ["Karachi", "Hyderabad", "Sukkur"], "Khyber Pakhtunkhwa": ["Peshawar", "Abbottabad", "Mardan"], "Balochistan": ["Quetta", "Gwadar"] }; // Populate city dropdown based on selected province function populateCitySelect(province) { const citySelect = document.getElementById("citySelect"); citySelect.innerHTML = "<option value=''>Select City</option>"; if (provinceToCities[province]) { provinceToCities[province].forEach(city => { const option = document.createElement("option"); option.value = city; option.textContent = city; citySelect.appendChild(option); }); } } document.addEventListener("DOMContentLoaded", () => { // Province dropdown listener to populate cities document.getElementById("provinceSelect").addEventListener("change", function(e) { populateCitySelect(e.target.value); }); // Handle form submission document.getElementById("createEventForm").addEventListener("submit", async function(e) { e.preventDefault(); // Collect form values const title = document.getElementById("eventTitle").value; const description = document.getElementById("eventDescription").value; const province = document.getElementById("provinceSelect").value; const city = document.getElementById("citySelect").value; const manualLocation = document.getElementById("manualLocation").value; const fullLocation = `${manualLocation} (${city}, ${province})`; const lat = document.getElementById("lat").value; const lng = document.getElementById("lng").value; // Process images: reverse order so last selected is first; simulate image URLs const imageUrls = []; const files = document.getElementById("eventImages").files; const fileArray = Array.from(files).reverse(); fileArray.forEach(file => { imageUrls.push(`https://dummyimage.com/300x150/cccccc/000000?text=${encodeURIComponent(title)}`); }); try { const docRef = await db.collection("events").add({ title: title, description: description, location: fullLocation, province: province, city: city, date: date,  // Add date/time if needed time: time, imageUrls: imageUrls, lat: lat, lng: lng, createdAt: firebase.firestore.FieldValue.serverTimestamp() }); alert("Event submitted successfully!"); // Redirect to event-submitted page with event ID window.location.href = "event-submitted.html?eventId=" + docRef.id; } catch (error) { console.error("Error adding event:", error); alert("Error submitting event."); } }); }); </script> </head> <body> <header> <nav> <a href="index.html">Home</a> <a href="auth.html">Sign In</a> <a href="contact.html">Contact</a> </nav> </header> <div class="container"> <h1>Create Event</h1> <form id="createEventForm"> <!-- 1. Image Preview & Upload --> <label>Image Preview:</label> <div id="imagePreview"></div> <label for="eventImages">Upload Images (select one or more):</label> <input type="file" id="eventImages" name="eventImages" accept="image/*" multiple required> <!-- 2. Title --> <label for="eventTitle">Title:</label> <input type="text" id="eventTitle" name="eventTitle" required> <!-- 3. Description --> <label for="eventDescription">Description:</label> <textarea id="eventDescription" name="eventDescription" rows="4" required></textarea> <!-- 4. Province & City Selection --> <label for="provinceSelect">Select Province:</label> <select id="provinceSelect" name="provinceSelect" required> <option value="">Select Province</option> <option value="Punjab">Punjab</option> <option value="Sindh">Sindh</option> <option value="Khyber Pakhtunkhwa">Khyber Pakhtunkhwa</option> <option value="Balochistan">Balochistan</option> </select> <label for="citySelect">Select City:</label> <select id="citySelect" name="citySelect" required> <option value="">Select City</option> <!-- Cities will be populated dynamically --> </select> <!-- 5. Date & Time Section --> <label for="eventDate">Date:</label> <input type="date" id="eventDate" name="eventDate" required> <label for="eventTime">Time:</label> <input type="time" id="eventTime" name="eventTime" required> <!-- 6. Manual Location Input & Integrated Map --> <label for="manualLocation">Enter Location (address):</label> <input type="text" id="manualLocation" name="manualLocation" placeholder="e.g., Street, Area" onblur="geocodeAddress()" required> <label>Pick Location on Map:</label> <div id="map"></div> <!-- Hidden fields for latitude and longitude --> <input type="hidden" id="lat" name="lat" required> <input type="hidden" id="lng" name="lng" required> <!-- 7. Submit Button with spacing --> <div style="margin-top:20px;"> <button type="submit">Submit Event</button> </div> </form> </div> </body> </html>
