<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Create Event</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; }
    header { background: #fff; padding: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    nav a { margin: 0 10px; text-decoration: none; color: #333; }
    .container { width: 90%; max-width: 600px; margin: 20px auto; background: #fff; padding: 20px; border-radius: 5px; }
    form { display: flex; flex-direction: column; }
    label { font-weight: bold; margin-top: 10px; }
    input, textarea { padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px; }
    input[type="file"] { padding: 5px; }
    button[type="submit"] { padding: 10px; background: #333; color: #fff; border: none; border-radius: 5px; cursor: pointer; }
    .map-placeholder { width:100%; height:300px; background:#eee; text-align:center; line-height:300px; margin-bottom:15px; }
  </style>
</head>
<body>
  <header>
    <nav>
      <a href="index.html">Home</a>
      <a href="auth.html">Sign In</a>
      <a href="contact.html">Contact</a>
    </nav>
  </header>
 <div class="container">
  <h1>Create Event</h1>
  <form id="createEventForm">
    <label for="eventTitle">Title:</label>
    <input type="text" id="eventTitle" name="eventTitle" required>

    <label for="eventDescription">Description:</label>
    <textarea id="eventDescription" name="eventDescription" rows="4" required></textarea>

    <label for="eventDate">Date:</label>
    <input type="date" id="eventDate" name="eventDate" required>

    <label for="eventTime">Time:</label>
    <input type="time" id="eventTime" name="eventTime" required>

    <label for="eventLocation">Location (text):</label>
    <input type="text" id="eventLocation" name="eventLocation" placeholder="Enter address" required>

    <label>Pick Location on Map:</label>
    <div id="map" style="width:100%; height:300px; margin-bottom:15px;"></div>
    <!-- Hidden inputs to store latitude and longitude -->
    <input type="hidden" id="lat" name="lat" required>
    <input type="hidden" id="lng" name="lng" required>

    <label for="eventImages">Upload Images (3 to 5):</label>
    <input type="file" id="eventImages" name="eventImages" accept="image/*" multiple required>

    <button type="submit">Submit Event</button>
  </form>
</div>

  
  <script>
  document.getElementById('createEventForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    // Collect form values
    const title = document.getElementById("eventTitle").value;
    const description = document.getElementById("eventDescription").value;
    const date = document.getElementById("eventDate").value;
    const time = document.getElementById("eventTime").value;
    const locationText = document.getElementById("eventLocation").value;
    const lat = document.getElementById("lat").value;
    const lng = document.getElementById("lng").value;
    
    // For image uploads, here we simulate with a placeholder URL.
    // In a real scenario, you would upload images to Firebase Storage and get their URLs.
    const imageUrls = [];
    const files = document.getElementById("eventImages").files;
    for (let i = 0; i < files.length; i++) {
      imageUrls.push("https://via.placeholder.com/300x150?text=" + encodeURIComponent(title));
    }
    
    try {
      // Save event data to Firestore
      await db.collection("events").add({
        title: title,
        description: description,
        date: date,
        time: time,
        location: locationText,
        lat: parseFloat(lat),
        lng: parseFloat(lng),
        imageUrls: imageUrls,
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      });
      alert("Event submitted successfully!");
      // Redirect back to homepage
      window.location.href = "index.html";
    } catch (error) {
      console.error("Error adding event: ", error);
      alert("Error submitting event.");
    }
  });
</script>
</body>
</html>
